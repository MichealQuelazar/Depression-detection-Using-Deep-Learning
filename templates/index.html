<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="AI-powered depression detection through image analysis" />
  <title>MindScope - Depression Detection Platform</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo">
        <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 7.5V9M15 11.5C15.8 12.3 16 13.4 16 14.5C16 15.4 15.8 16.5 15 17.3V19L21 17V15L15 15.5M9 13.5L7 12L2 13L4 14.5L2 16L7 17L9 15.5V13.5ZM11 20C11 21.1 11.9 22 13 22H15C16.1 22 17 21.1 17 20V19H11V20Z" fill="currentColor"/>
        </svg>
        <h1 class="logo-text">MindScope</h1>
      </div>
      <p class="subtitle">AI-Powered Mental Health Assessment</p>
    </header>

    <main class="main-content">
      <div class="upload-section">
        <div class="upload-card">
          <div class="upload-header">
            <h2>Upload Image for Analysis</h2>
            <p class="upload-description">Our AI model analyzes facial expressions and features to provide mental health insights</p>
          </div>

          <form method="post" enctype="multipart/form-data" class="upload-form">
            <div class="file-upload-area" id="dropZone">
              <input type="file" name="file" id="fileInput" class="file-input" accept="image/*" required />
              <label for="fileInput" class="file-label">
                <svg class="upload-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z" fill="currentColor"/>
                </svg>
                <span class="upload-text">
                  <strong>Click to upload</strong> or drag and drop
                </span>
                <span class="upload-hint">PNG, JPG, JPEG up to 10MB</span>
              </label>
            </div>

            <div class="preview-container">
              <img id="preview" class="preview-image" alt="Uploaded image preview" />
              <button type="button" class="remove-image" id="removeImage" aria-label="Remove image">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
                </svg>
              </button>
            </div>

            <button type="submit" class="analyze-btn" id="analyzeBtn" disabled>
              <svg class="btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span class="btn-text">Analyze Image</span>
              <div class="loading-spinner"></div>
            </button>
          </form>

          {% if result %}
            <div class="result-section">
              <div class="result-card {{ 'positive' if result == 'Not Depressed' else 'negative' }}">
                <div class="result-icon">
                  {% if result == 'Not Depressed' %}
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  {% else %}
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 9V13M12 17H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  {% endif %}
                </div>
                <div class="result-content">
                  <h3 class="result-title">Analysis Complete</h3>
                  <p class="result-text">{{ result }}</p>
                  <div class="result-disclaimer">
                    <small>This is an AI assessment and should not replace professional medical advice.</small>
                  </div>
                </div>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </main>

    <footer class="footer">
      <p>&copy; 2024 MindScope. This tool is for educational purposes only.</p>
    </footer>
  </div>

  <script>
    const fileInput = document.getElementById("fileInput");
    const preview = document.getElementById("preview");
    const previewContainer = document.querySelector(".preview-container");
    const removeBtn = document.getElementById("removeImage");
    const analyzeBtn = document.getElementById("analyzeBtn");
    const dropZone = document.getElementById("dropZone");
    const uploadForm = document.querySelector(".upload-form");

    // File input change handler
    fileInput.addEventListener("change", handleFileSelect);
    
    // Drag and drop handlers
    dropZone.addEventListener("dragover", handleDragOver);
    dropZone.addEventListener("dragleave", handleDragLeave);
    dropZone.addEventListener("drop", handleDrop);
    
    // Remove image handler
    removeBtn.addEventListener("click", removeImage);
    
    // Form submit handler
    uploadForm.addEventListener("submit", handleSubmit);

    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (file) {
        displayPreview(file);
      }
    }

    function handleDragOver(e) {
      e.preventDefault();
      dropZone.classList.add("drag-over");
    }

    function handleDragLeave(e) {
      e.preventDefault();
      dropZone.classList.remove("drag-over");
    }

    function handleDrop(e) {
      e.preventDefault();
      dropZone.classList.remove("drag-over");
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        fileInput.files = files;
        displayPreview(files[0]);
      }
    }

    function displayPreview(file) {
      if (file && file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = function(e) {
          preview.src = e.target.result;
          previewContainer.style.display = "block";
          analyzeBtn.disabled = false;
        };
        reader.readAsDataURL(file);
      }
    }

    function removeImage() {
      fileInput.value = "";
      preview.src = "";
      previewContainer.style.display = "none";
      analyzeBtn.disabled = true;
    }

    function handleSubmit(e) {
      analyzeBtn.classList.add("loading");
      analyzeBtn.disabled = true;
    }
  </script>
</body>
</html>
